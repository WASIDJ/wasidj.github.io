<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>微服务 on Ryou's Blog</title><link>https://www.jeffkafka.top/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/</link><description>Recent content in 微服务 on Ryou's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Tue, 10 Feb 2026 16:17:36 +0800</lastBuildDate><atom:link href="https://www.jeffkafka.top/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/index.xml" rel="self" type="application/rss+xml"/><item><title>grpc</title><link>https://www.jeffkafka.top/post/grpc/</link><pubDate>Tue, 03 Feb 2026 13:11:24 +0800</pubDate><guid>https://www.jeffkafka.top/post/grpc/</guid><description>&lt;img src="https://w.wallhaven.cc/full/po/wallhaven-polllj.jpg" alt="Featured image of post grpc" /&gt;&lt;h1 id="grpc-详解"&gt;gRPC 详解
&lt;/h1&gt;&lt;h2 id="1-背景与定义"&gt;1. 背景与定义
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;gRPC&lt;/strong&gt; (gRPC Remote Procedure Calls) 是 Google 于 2015 年开源的高性能、通用的 &lt;strong&gt;RPC (远程过程调用)&lt;/strong&gt; 框架。它基于 &lt;strong&gt;HTTP/2&lt;/strong&gt; 协议传输，使用 &lt;strong&gt;Protocol Buffers&lt;/strong&gt; 作为接口定义语言 (IDL) 和序列化格式。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;官方定义：gRPC 是一个高性能、开源和通用的 RPC 框架，面向移动和 HTTP/2 设计。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;官方网站：&lt;a class="link" href="https://grpc.io/" target="_blank" rel="noopener"
&gt;gRPC - A high performance, open source universal RPC framework&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;GitHub 仓库：&lt;a class="link" href="https://github.com/grpc/grpc" target="_blank" rel="noopener"
&gt;grpc/grpc&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="2-核心概念与架构"&gt;2. 核心概念与架构
&lt;/h2&gt;&lt;h3 id="21-核心组件"&gt;2.1 核心组件
&lt;/h3&gt;&lt;pre class="mermaid"&gt;
flowchart TB
subgraph Client[&amp;#34;客户端&amp;#34;]
C1[&amp;#34;Client Stub&amp;lt;br/&amp;gt;(生成的代码)&amp;#34;]
C2[&amp;#34;序列化&amp;#34;]
C3[&amp;#34;HTTP/2 客户端&amp;#34;]
end
subgraph Server[&amp;#34;服务端&amp;#34;]
S1[&amp;#34;HTTP/2 服务端&amp;#34;]
S2[&amp;#34;反序列化&amp;#34;]
S3[&amp;#34;Server Skeleton&amp;lt;br/&amp;gt;(生成的代码)&amp;#34;]
S4[&amp;#34;服务实现&amp;#34;]
end
subgraph Proto[&amp;#34;接口定义&amp;#34;]
P1[&amp;#34;.proto 文件&amp;#34;]
end
P1 --&amp;gt;|&amp;#34;protoc 编译器&amp;#34;| C1
P1 --&amp;gt;|&amp;#34;protoc 编译器&amp;#34;| S3
C1 --&amp;gt; C2 --&amp;gt; C3
C3 --&amp;gt;|&amp;#34;HTTP/2 + Protobuf&amp;#34;| S1
S1 --&amp;gt; S2 --&amp;gt; S3 --&amp;gt; S4
&lt;/pre&gt;
&lt;h3 id="22-关键技术栈"&gt;2.2 关键技术栈
&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;组件&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;HTTP/2&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;二进制分帧、多路复用、头部压缩、服务端推送&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Protocol Buffers&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;高效的二进制序列化格式，比 JSON 更小更快&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;gRPC Stub&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;由 protoc 生成的客户端/服务端代码&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Channel&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;到 gRPC 服务端的连接抽象&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Call&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;单次 RPC 调用的抽象&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id="3-四种通信模式"&gt;3. 四种通信模式
&lt;/h2&gt;&lt;p&gt;gRPC 支持四种通信模式，充分利用 HTTP/2 的双向流能力：&lt;/p&gt;
&lt;pre class="mermaid"&gt;
flowchart LR
subgraph Modes[&amp;#34;gRPC 四种通信模式&amp;#34;]
direction TB
M1[&amp;#34;1.Unary RPC&amp;lt;br/&amp;gt;一元调用&amp;#34;]
M2[&amp;#34;2.Server Streaming&amp;lt;br/&amp;gt;服务端流&amp;#34;]
M3[&amp;#34;3.Client Streaming&amp;lt;br/&amp;gt;客户端流&amp;#34;]
M4[&amp;#34;4.Bidirectional Streaming&amp;lt;br/&amp;gt;双向流&amp;#34;]
end
M1 --&amp;gt; D1[&amp;#34;请求 → 响应&amp;lt;br/&amp;gt;(1:1)&amp;#34;]
M2 --&amp;gt; D2[&amp;#34;请求 → 流响应&amp;lt;br/&amp;gt;(1:N)&amp;#34;]
M3 --&amp;gt; D3[&amp;#34;流请求 → 响应&amp;lt;br/&amp;gt;(N:1)&amp;#34;]
M4 --&amp;gt; D4[&amp;#34;流请求 ↔ 流响应&amp;lt;br/&amp;gt;(N:M)&amp;#34;]
&lt;/pre&gt;
&lt;h3 id="31-模式详解"&gt;3.1 模式详解
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-protobuf" data-lang="protobuf"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;// 1. Unary RPC - 传统请求响应
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;rpc&lt;/span&gt; GetUser(GetUserRequest) &lt;span style="color:#66d9ef"&gt;returns&lt;/span&gt; (User);&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;// 2. Server Streaming - 服务端流式响应
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;rpc&lt;/span&gt; ListUsers(ListUsersRequest) &lt;span style="color:#66d9ef"&gt;returns&lt;/span&gt; (stream User);&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;// 3. Client Streaming - 客户端流式请求
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;rpc&lt;/span&gt; UploadFile(stream FileChunk) &lt;span style="color:#66d9ef"&gt;returns&lt;/span&gt; (UploadResponse);&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;// 4. Bidirectional Streaming - 双向流
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;rpc&lt;/span&gt; Chat(stream Message) &lt;span style="color:#66d9ef"&gt;returns&lt;/span&gt; (stream Message);&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h2 id="4-工作流程"&gt;4. 工作流程
&lt;/h2&gt;&lt;pre class="mermaid"&gt;
sequenceDiagram
participant Dev as 开发者
participant Proto as .proto 文件
participant Compiler as protoc 编译器
participant Client as 客户端
participant Network as 网络 (HTTP/2)
participant Server as 服务端
Dev-&amp;gt;&amp;gt;Proto: 1. 定义服务接口
Proto-&amp;gt;&amp;gt;Compiler: 2. 编译 .proto
Compiler-&amp;gt;&amp;gt;Client: 3. 生成 Client Stub
Compiler-&amp;gt;&amp;gt;Server: 4. 生成 Server Skeleton
Client-&amp;gt;&amp;gt;Client: 5. 调用 Stub 方法
Client-&amp;gt;&amp;gt;Client: 6. 序列化
Client-&amp;gt;&amp;gt;Network: 7. HTTP/2 请求
Network-&amp;gt;&amp;gt;Server: 8. 传输二进制数据
Server-&amp;gt;&amp;gt;Server: 9. 反序列化
Server-&amp;gt;&amp;gt;Server: 10. 执行服务方法
Server-&amp;gt;&amp;gt;Network: 11. HTTP/2 响应
Network-&amp;gt;&amp;gt;Client: 12. 返回结果
Client-&amp;gt;&amp;gt;Client: 13. 反序列化
Client-&amp;gt;&amp;gt;Dev: 14. 返回响应对象
&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 id="5-protocol-buffers-示例"&gt;5. Protocol Buffers 示例
&lt;/h2&gt;&lt;h3 id="51-定义-proto-文件"&gt;5.1 定义 Proto 文件
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-protobuf" data-lang="protobuf"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;// user.proto
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;syntax &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;proto3&amp;#34;&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;package&lt;/span&gt; user;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;option&lt;/span&gt; go_package &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;./pb&amp;#34;&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;// 服务定义
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;service&lt;/span&gt; UserService {&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;// Unary RPC
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;rpc&lt;/span&gt; GetUser(GetUserRequest) &lt;span style="color:#66d9ef"&gt;returns&lt;/span&gt; (User);&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;// Server Streaming
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;rpc&lt;/span&gt; ListUsers(ListUsersRequest) &lt;span style="color:#66d9ef"&gt;returns&lt;/span&gt; (stream User);&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;// Client Streaming
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;rpc&lt;/span&gt; CreateUsers(stream CreateUserRequest) &lt;span style="color:#66d9ef"&gt;returns&lt;/span&gt; (CreateUsersResponse);&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;// Bidirectional Streaming
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;rpc&lt;/span&gt; Chat(stream ChatMessage) &lt;span style="color:#66d9ef"&gt;returns&lt;/span&gt; (stream ChatMessage);&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;// 消息定义
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;message&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;User&lt;/span&gt; {&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;int32&lt;/span&gt; id &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;string&lt;/span&gt; name &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;string&lt;/span&gt; email &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;3&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;repeated&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;string&lt;/span&gt; roles &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;4&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;message&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;GetUserRequest&lt;/span&gt; {&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;int32&lt;/span&gt; id &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;message&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;ListUsersRequest&lt;/span&gt; {&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;int32&lt;/span&gt; page &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;int32&lt;/span&gt; page_size &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;message&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;CreateUserRequest&lt;/span&gt; {&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;string&lt;/span&gt; name &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;string&lt;/span&gt; email &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;message&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;CreateUsersResponse&lt;/span&gt; {&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;repeated&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;int32&lt;/span&gt; ids &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;int32&lt;/span&gt; total &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;message&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;ChatMessage&lt;/span&gt; {&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;int32&lt;/span&gt; user_id &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;string&lt;/span&gt; content &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;2&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;int64&lt;/span&gt; timestamp &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;3&lt;/span&gt;;&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}&lt;span style="color:#960050;background-color:#1e0010"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="52-生成代码"&gt;5.2 生成代码
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# Go 语言&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;protoc --go_out&lt;span style="color:#f92672"&gt;=&lt;/span&gt;. --go-grpc_out&lt;span style="color:#f92672"&gt;=&lt;/span&gt;. user.proto
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# Java&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;protoc --java_out&lt;span style="color:#f92672"&gt;=&lt;/span&gt;. --grpc-java_out&lt;span style="color:#f92672"&gt;=&lt;/span&gt;. user.proto
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# Python&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;python -m grpc_tools.protoc -I. --python_out&lt;span style="color:#f92672"&gt;=&lt;/span&gt;. --grpc_python_out&lt;span style="color:#f92672"&gt;=&lt;/span&gt;. user.proto
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h2 id="6-grpc-vs-rest-对比"&gt;6. gRPC vs REST 对比
&lt;/h2&gt;&lt;pre class="mermaid"&gt;
flowchart LR
subgraph REST[&amp;#34;REST API&amp;#34;]
R1[&amp;#34;HTTP/1.1&amp;#34;]
R2[&amp;#34;JSON/XML&amp;#34;]
R3[&amp;#34;文本传输&amp;#34;]
R4[&amp;#34;请求-响应&amp;#34;]
end
subgraph gRPC[&amp;#34;gRPC&amp;#34;]
G1[&amp;#34;HTTP/2&amp;#34;]
G2[&amp;#34;Protocol Buffers&amp;#34;]
G3[&amp;#34;二进制传输&amp;#34;]
G4[&amp;#34;四种流模式&amp;#34;]
end
REST --&amp;gt; |&amp;#34;性能较低&amp;#34;| gRPC
&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;特性&lt;/th&gt;
&lt;th&gt;gRPC&lt;/th&gt;
&lt;th&gt;REST&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;协议&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;HTTP/2&lt;/td&gt;
&lt;td&gt;HTTP/1.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;数据格式&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Protocol Buffers (二进制)&lt;/td&gt;
&lt;td&gt;JSON/XML (文本)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;性能&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;高 (二进制 + 头部压缩)&lt;/td&gt;
&lt;td&gt;较低&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;流式传输&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;✅ 支持 4 种模式&lt;/td&gt;
&lt;td&gt;❌ 仅请求-响应&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;代码生成&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;✅ 自动生成强类型 Stub&lt;/td&gt;
&lt;td&gt;❌ 需手动或第三方工具&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;浏览器支持&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;❌ 需要 gRPC-Web 代理&lt;/td&gt;
&lt;td&gt;✅ 原生支持&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;调试难度&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;较高 (二进制不可读)&lt;/td&gt;
&lt;td&gt;低 (文本可读)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;学习曲线&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;较陡&lt;/td&gt;
&lt;td&gt;平缓&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id="7-多语言支持"&gt;7. 多语言支持
&lt;/h2&gt;&lt;p&gt;gRPC 官方支持多种编程语言：&lt;/p&gt;
&lt;pre class="mermaid"&gt;
mindmap
root((gRPC))
官方支持
Go
Java
C/C++
Python
Ruby
C#
Node.js
Android Java
Objective-C
PHP
Dart
第三方支持
Rust
Swift
Scala
Elixir
Haskell
&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 id="8-实际应用场景"&gt;8. 实际应用场景
&lt;/h2&gt;&lt;h3 id="81-适用场景"&gt;8.1 适用场景
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;微服务架构&lt;/strong&gt;：服务间高性能通信&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;实时通信&lt;/strong&gt;：聊天应用、实时数据推送&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;物联网&lt;/strong&gt;：低带宽、高效率的数据传输&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;移动应用&lt;/strong&gt;：减少网络流量和延迟&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;大数据传输&lt;/strong&gt;：流式上传/下载&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="82-架构示例"&gt;8.2 架构示例
&lt;/h3&gt;&lt;pre class="mermaid"&gt;
flowchart TB
subgraph Frontend[&amp;#34;前端&amp;#34;]
Web[&amp;#34;Web App&amp;lt;br/&amp;gt;(gRPC-Web)&amp;#34;]
Mobile[&amp;#34;Mobile App&amp;lt;br/&amp;gt;(gRPC Native)&amp;#34;]
end
subgraph Gateway[&amp;#34;API Gateway&amp;#34;]
GW[&amp;#34;Envoy/Nginx&amp;lt;br/&amp;gt;gRPC-Web 代理&amp;#34;]
end
subgraph Backend[&amp;#34;后端微服务&amp;#34;]
S1[&amp;#34;User Service&amp;lt;br/&amp;gt;(Go)&amp;#34;]
S2[&amp;#34;Order Service&amp;lt;br/&amp;gt;(Java)&amp;#34;]
S3[&amp;#34;Payment Service&amp;lt;br/&amp;gt;(Python)&amp;#34;]
S4[&amp;#34;Notification Service&amp;lt;br/&amp;gt;(Node.js)&amp;#34;]
end
subgraph DB[&amp;#34;数据层&amp;#34;]
D1[(&amp;#34;PostgreSQL&amp;#34;)]
D2[(&amp;#34;Redis&amp;#34;)]
D3[(&amp;#34;Kafka&amp;#34;)]
end
Web --&amp;gt; GW
Mobile --&amp;gt; S1
GW --&amp;gt; S1
GW --&amp;gt; S2
S1 &amp;lt;--&amp;gt;|&amp;#34;gRPC&amp;#34;| S2
S2 &amp;lt;--&amp;gt;|&amp;#34;gRPC&amp;#34;| S3
S3 &amp;lt;--&amp;gt;|&amp;#34;gRPC&amp;#34;| S4
S1 --&amp;gt; D1
S2 --&amp;gt; D1
S3 --&amp;gt; D2
S4 --&amp;gt; D3
&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 id="9-优缺点总结"&gt;9. 优缺点总结
&lt;/h2&gt;&lt;h3 id="91-优点"&gt;9.1 优点
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;✅ &lt;strong&gt;高性能&lt;/strong&gt;：二进制序列化 + HTTP/2 多路复用&lt;/li&gt;
&lt;li&gt;✅ &lt;strong&gt;强类型&lt;/strong&gt;：通过 .proto 自动生成代码，减少运行时错误&lt;/li&gt;
&lt;li&gt;✅ &lt;strong&gt;双向流&lt;/strong&gt;：支持实时通信场景&lt;/li&gt;
&lt;li&gt;✅ &lt;strong&gt;多语言&lt;/strong&gt;：官方支持 10+ 种语言&lt;/li&gt;
&lt;li&gt;✅ &lt;strong&gt;内置功能&lt;/strong&gt;：超时、取消、元数据、认证、负载均衡&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="92-缺点"&gt;9.2 缺点
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;❌ &lt;strong&gt;浏览器支持有限&lt;/strong&gt;：需要 gRPC-Web 代理&lt;/li&gt;
&lt;li&gt;❌ &lt;strong&gt;调试困难&lt;/strong&gt;：二进制格式不可直接阅读&lt;/li&gt;
&lt;li&gt;❌ &lt;strong&gt;学习曲线&lt;/strong&gt;：需要学习 Protocol Buffers 和 gRPC 概念&lt;/li&gt;
&lt;li&gt;❌ &lt;strong&gt;工具链依赖&lt;/strong&gt;：需要 protoc 编译器和各语言插件&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="10-最佳实践"&gt;10. 最佳实践
&lt;/h2&gt;&lt;h3 id="101-错误处理"&gt;10.1 错误处理
&lt;/h3&gt;&lt;p&gt;gRPC 定义了标准错误码：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;错误码&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;OK&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;成功&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CANCELLED&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;操作被取消&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;UNKNOWN&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;未知错误&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;INVALID_ARGUMENT&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;无效参数&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DEADLINE_EXCEEDED&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;超时&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;NOT_FOUND&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;资源不存在&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ALREADY_EXISTS&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;资源已存在&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;PERMISSION_DENIED&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;权限不足&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;UNAUTHENTICATED&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;未认证&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;RESOURCE_EXHAUSTED&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;资源耗尽&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;UNAVAILABLE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;服务不可用&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id="102-性能优化建议"&gt;10.2 性能优化建议
&lt;/h3&gt;&lt;pre class="mermaid"&gt;
flowchart LR
subgraph Optimizations[&amp;#34;性能优化&amp;#34;]
O1[&amp;#34;连接复用&amp;#34;]
O2[&amp;#34;流式传输大数据&amp;#34;]
O3[&amp;#34;合理设置 Deadline&amp;#34;]
O4[&amp;#34;启用压缩&amp;#34;]
O5[&amp;#34;连接池管理&amp;#34;]
end
O1 --&amp;gt; R1[&amp;#34;减少 TCP 握手开销&amp;#34;]
O2 --&amp;gt; R2[&amp;#34;避免大消息阻塞&amp;#34;]
O3 --&amp;gt; R3[&amp;#34;防止资源泄漏&amp;#34;]
O4 --&amp;gt; R4[&amp;#34;减少网络传输&amp;#34;]
O5 --&amp;gt; R5[&amp;#34;提高并发性能&amp;#34;]
&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 id="11-参考链接"&gt;11. 参考链接
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;a class="link" href="https://grpc.io/docs/" target="_blank" rel="noopener"
&gt;gRPC 官方文档&lt;/a&gt; — 官方完整文档&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://protobuf.dev/" target="_blank" rel="noopener"
&gt;Protocol Buffers 官方文档&lt;/a&gt; — Google Protocol Buffers&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://github.com/grpc/grpc" target="_blank" rel="noopener"
&gt;gRPC GitHub 仓库&lt;/a&gt; — 源码和 Issue 追踪&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://github.com/grpc/grpc-web" target="_blank" rel="noopener"
&gt;gRPC-Web&lt;/a&gt; — 浏览器端 gRPC 支持&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://datatracker.ietf.org/doc/html/rfc7540" target="_blank" rel="noopener"
&gt;HTTP/2 RFC 7540&lt;/a&gt; — HTTP/2 协议规范&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://grpc.io/docs/guides/benchmarking/" target="_blank" rel="noopener"
&gt;gRPC 性能基准测试&lt;/a&gt; — 官方性能测试指南&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;div class="admonition tip"&gt;
&lt;div class="admonition-header"&gt;&lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"&gt;&lt;path d="M272 384c9.6-31.9 29.5-59.1 49.2-86.2c0 0 0 0 0 0c5.2-7.1 10.4-14.2 15.4-21.4c19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3c5 7.2 10.2 14.3 15.4 21.4c0 0 0 0 0 0c19.8 27.1 39.7 54.4 49.2 86.2l160 0zM192 512c44.2 0 80-35.8 80-80l0-16-160 0 0 16c0 44.2 35.8 80 80 80zM112 176c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112c8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"/&gt;&lt;/svg&gt;
&lt;span&gt;小结&lt;/span&gt;
&lt;/div&gt;
&lt;div class="admonition-content"&gt;
&lt;p&gt;gRPC 是现代微服务架构中服务间通信的优选方案，特别适合对性能和效率有高要求的场景。如果你的系统需要跨语言、高性能、实时通信，gRPC 是值得考虑的选择。
[!summary] 前情提要&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item></channel></rss>